import pandas as pd
import numpy as np
from sklearn.feature_selection import SelectKBest, chi2
from sklearn.datasets import load_iris

# --- 1. Load and Prepare the Iris Dataset ---
# The Iris dataset is included with scikit-learn
iris = load_iris()
X = iris.data
y = iris.target
all_feature_names = iris.feature_names



# --- 2. Apply Chi-Squared Feature Selection ---
# We will select the 'k' best features. Let's choose k=2 for this example.
k_best_features = 2

# Create the selector object.
# The score_func=chi2 calculates the chi-squared statistic between each feature and the target.
selector = SelectKBest(score_func=chi2, k=k_best_features)

# Run the feature selection on the data
X_new = selector.fit_transform(X, y)

# Get the names of the selected features
# get_support() returns a boolean mask of the selected features
selected_indices = selector.get_support(indices=True)
selected_features = [all_feature_names[i] for i in selected_indices]


# --- 3. Display the Results ---
print("--- Feature Selection Results ---")
# selector.scores_ holds the chi2 score for each feature
print(f"Chi-squared scores for each feature: {np.round(selector.scores_, 2)}")
print(f"\nOriginal number of features: {X.shape[1]}")
print(f"Reduced number of features: {X_new.shape[1]}")
print(f"Selected features: {selected_features}")
